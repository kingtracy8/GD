<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Personal Info</title>

    <link rel="stylesheet" href="../js/css/layui.css">
    <style>
        body {
            margin: 10px;
        }
    </style>

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script>

        //ajax获取个人信息
        $(function () {
            $.ajax({
                url: "http://localhost:8080/user/PersonDetail",
                type: "POST",
                //   data: JSON.stringify(user), //转JSON字符串
                dataType: 'json',
                contentType: 'application/json;charset=UTF-8', //contentType很重要
                success: function (result) {
                    // var data = eval('('+result+')');
                    // $("#ti").text(result.userName);
                    $("#userId").val(result.userId);
                    $("#Id").val(result.userId);
                    $("#userName").val(result.userName);
                    $("#userNum").val(result.userNum);
                    $("#userPassword").val(result.userPassword);
                    $("#userGender").val(result.userGender);
                    $("#userDepartment").attr("value", result.userDepartment);
                    $("#userDepartment").attr("text", result.userDepartment);
                    $("#userDepartment").get(0).value = result.userDepartment;
                    $("#userDepartment").val(result.userDepartment);
                }
            })
        });


        $(function () {
            //先用ajax获得当前的用户身份
            $.ajax({
                url: "http://localhost:8080/user/GetIdentity",
                type: "POST",
                dataType: 'json',
                contentType: 'application/json;charset=UTF-8', //contentType很重要
                success: function (result) {
                    var identity = result.identity;
                    // layer.msg(identity);
                    $("#identity").text(identity);
                    document.getElementById("identity").text = identity;
                }
            });


        });

    </script>


</head>
<body>

<blockquote class="layui-elem-quote layui-quote-nm ">

    <fieldset class="layui-elem-field layui-field-title ">
        <legend style="margin-bottom: 20px; margin-left: 450px">个人信息修改</legend>

        <div class="layui-field-box">
            <form class="layui-form" action="">
                <div class="layui-form-item">
                    <label class="layui-form-label " style="margin-left: 26%" >用户id:</label>
                    <div class="layui-input-block">
                        <input type="text" style="width: 190px;background: rgba(121,145,58,0.53)" name="userId"
                               id="userId" disabled autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="margin-left: 26%">用户名:</label>
                    <div class="layui-input-block">
                        <input type="text" style="width: 190px;" name="userName" id="userName" required
                               lay-verify="required" placeholder="请输入用户名" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="margin-left: 26%">用户编号:</label>
                    <div class="layui-input-block">
                        <input type="text" style="width: 190px;" name="userNum" id="userNum" required
                               lay-verify="required" placeholder="请输入用户编号" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="margin-left: 26%">密码:</label>
                    <div class="layui-input-inline">
                        <input type="password" name="userPassword" id="userPassword" required lay-verify="required"
                               placeholder="请输入密码" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="margin-left: 26%">部门:</label>
                    <div class="layui-input-block" style="width: 190px;margin-left: 34.5%">
                        <select id="userDepartment" name="userDepartment" class="userDepartment"  lay-verify="required">
                            <option value=""></option>
                            <option value="数学与计算机科学学院">数学与计算机科学学院</option>
                            <option value="外国语学院">外国语学院</option>
                            <option value="化工学院">化工学院</option>
                            <option value="生命科学学院">生命科学学院</option>
                            <option value="管理学院">管理学院</option>
                        </select>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label" style="margin-left: 26%">性别:</label>
                    <div class="layui-input-block" id="userGender">
                        <input type="radio" name="userGender" value="男" title="男" checked>
                        <input type="radio" name="userGender" value="女" title="女">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn" lay-submit lay-filter="formDemo" style="margin-left: 29%">提交</button>
                        <button type="button" class="layui-btn layui-btn-primary"><a href="welcome.html">返回</a></button>
                    </div>
                </div>
            </form>
            <div id="identity" style="display: none"></div>
            <div id="Id" style="display: none"></div>
        </div>

    </fieldset>
</blockquote>

</body>
<script src="../js/jquery-3.2.1.min.js"></script>
<script src="../../js/layui.js"></script>
<script>
    //Demo
    layui.use('form', function () {
        var form = layui.form;

        //监听提交
        form.on('submit(formDemo)',function (data) {


      //      if (document.getElementById("identity").innerHTML == "user") {
                //layer.msg("当前用户身份:"+document.getElementById("identity").innerHTML);
                //传入后端并更新
               // layer.msg(JSON.stringify(data.field));
                $.ajax({
                    url: "http://localhost:8080/user/EditUser",
                    type: "POST",
                    data: JSON.stringify(data.field), //转JSON字符串
                    dataType: 'json',
                    contentType: 'application/json;charset=UTF-8', //contentType很重要
                    success: function (result) {
                        layer.msg("用户信息更改成功!");
                    }
                })
         //   }
            return false;
        });
    });


</script>

</html>